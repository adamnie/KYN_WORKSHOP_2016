<!doctype html>
<html lang="en">

	<head>
		<meta charset="utf-8">

		<title>Warsztaty Koło</title>

		<meta name="description" content="Summary presentation from PyCon2015 PL conference for Ericpol">
		<meta name="author" content="Adam Niedziałkowski">

		<meta name="apple-mobile-web-app-capable" content="yes" />
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />

		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">

		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css" id="theme">

		<!-- Code syntax highlighting -->
		<link rel="stylesheet" href="lib/css/zenburn.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>

		<!--[if lt IE 9]>
		<script src="lib/js/html5shiv.js"></script>
		<![endif]-->
	</head>

	<body>

		<div class="reveal">

			<!-- Any section element inside of this container is displayed as a slide -->
			<div class="slides">
				<section>
					<h2>Środowisko</h2>
					<p class="fragment">
						Java 1.7
					</p>
					<p class="fragment">
						Android Studio
					</p>
					<p class="fragment">
						Sdk 23.2
					</p>
					<p class="fragment">
						Estimote Sdk
					</p>
					<p class="fragment">
						Telefon + BLE + Android 5.1
					</p>
					<p class="fragment">
						Estimote Stickers
					</p>

				</section>

				<section>
					<h2 class="fragment">Jak zimne jest twoje... </h2>
					<h2 class="fragment">... piwo?</h2>
				</section>

				<section>
					<img src="img/Motywacja.png" width="500" height="400"alt=""  />
				</section>

				<section>
					<h2>Agenda</h2>
					<ol>
						<li class="fragment">Co będziemy budować</li>
						<li class="fragment">Wstęp do Internet of things</li>
						<li class="fragment">Srodowisko</li>
						<li class="fragment">Zbudujmy to!</li>
					</ol>
				</section>

				<section>
					<section>
							<h2>Co będziemy budować?</h2>
					</section>
					<section>
						<img src="img/screen1.png" width="350" height="600" alt="" />
					</section>
					<section>
						<img src="img/screen2.png" width="350" height="600" alt="" />
					</section>
					<section>
						<img src="img/screen3.png" width="350" height="600" alt="" />
					</section>

				</section>

				<section>
					<section>
							<h2>Internet of Things </h2>
					</section>
					<!-- IoT definition -->
					<section>
						<h3>Internet of Things ...</h3>
						<p class="fragment">... is a network of interconnected <em>things</em> ...</p>
						<p class="fragment">... embedded with electronics and sensors ...</p>
						<p class="fragment">... which enables them to achieve greater value and service ...</p>
						<p class="fragment">... by exchanging and analysing data.</p>
					</section>


					<!-- Examples -->
					<section data-markdown>
						## "Rzeczy"
						![thing](img/thing1.png)
						![thing](img/thing2.png)
						![thing](img/thing3.png)
						![thing](img/thing4.png)
						![thing](img/thing5.png)
						![thing](img/thing6.png)
					</section>

					<!-- First appliance -->
					<section>
						<h3>Pierwsze zastosowanie</h3>
						<img src="img/coke.png" alt="" />
					</section>


					<section>
						<h2>Beacon'y</h2>
						<p class="fragment">Dają kontekst</p>
						<p class="fragment">Mają wbudowane sensory</p>
						<p class="fragment">Komunikacja jednokierunkowa</p>
						<p class="fragment">Korzystają z BlueTooth LowEnergy</p>
					</section>

					<section data-background="img/nearable_back.png">

					</section>

					<section>
						<h2>Estimote stickers</h2>
						<p class="fragment">
							zasięg do ~7m
						</p>
						<p class="fragment">
							Wodoodporne
						</p>
						<p class="fragment">
							żyją około rok
						</p>
					</section>


					<section>
						Protokoły
						<p class="fragment">
							iBeacon
							<ul>
								<li class="fragment">Monitorowanie</li>
								<li class="fragment">Określanie odległości</li>
								<li class="fragment">UUID, major, minor</li>
							</ul>
						</p>
						<p class="fragment">
							Eddystone
							<ul>
								<li class="fragment">Status beacona</li>
							</ul>
						</p>
					</section>

					<section>
						<h2>Nearable Protocol</h2>
						<p class="fragment">typ</p>
						<p class="fragment">id</p>
						<p class="fragment">pozycja w przestrzeni</p>
						<p class="fragment">ruch w osiach X, Y, Z</p>
						<p class="fragment">temperature</p>
						<p class="fragment">moc sygnału</p>
						<p class="fragment">poziom baterii</p>
						<p class="fragment">firmware</p>
					</section>
					<section>
						<h2>Aplikacja Estimote</h2>
						<img src="img/sample-1.png" height="600"alt="" />
					</section>

					<section>
						<h2>Estimote Cloud</h2>
					</section>

				</section>

				<section>
					<section>
						<h2>Android</h2>
					</section>

					<section>
						<h3>Activity</h3>
							<pre><code class="language-java">
public class MainActivity extends Activity {

		@Override
		protected void onCreate(Bundle savedInstanceState) {
				super.onCreate(savedInstanceState);
				setContentView(R.layout.activity_main);
		}

}							</code></pre>
						</p>
					</section>
					<section>
						<img src="img/android-flow.png" class="stretch"></img>
					</section>

					<section>
						<h3>Fragment</h3>
							<p class="fragment"><pre><code class="language-java">
public class BeaconListFragment extends Fragment {
    public BeaconListFragment() {
        // Required empty public constructor
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_beacon_list, container, false);
    }
}
							</code></pre></p>

							</section>
							<section>
							<h3>Application</h3>
							<p ><pre><code class="language-java">
public class ApplicationKYN2016 extends Application {

    @Override
    public void onCreate() {
        super.onCreate();
    }
							</code></pre></p>
					</section>
					<section>
						<h3>Logger</h3>
						<p class="fragment"><em>debug (Log.d)</em></p>
						<p class="fragment">info (Log.i)</p>
						<p class="fragment">error (Log.e)</p>
						<p class="fragment">verbose (Log.v)</p>
						<p class="fragment">warn (Log.w)</p>
					</section>
					<section data-markdown>
						## Android studio
					</section>
					<section>
						<h2>Struktura projektu</h2>
						<img src="img/android-1.png"></img>
					</section>
					<section>
						<h3>Gradle</h3>
						<pre><code class="language-java">
android {
    compileSdkVersion 23
    buildToolsVersion "23.0.3"

    defaultConfig {
        applicationId "com.example.adam.kyn_workshop_2016"
        minSdkVersion 21
        targetSdkVersion 23
        versionCode 1
        versionName "1.0"
    }
	....		</code></pre>
					</section>
					<section>
						<pre><code class="language-java">
dependencies {
    compile fileTree(dir: 'libs', include: ['*.jar'])
    testCompile 'junit:junit:4.12'
    compile 'com.android.support:appcompat-v7:23.2.1'
    compile 'com.android.support:design:23.2.1'
    compile 'com.estimote:sdk:0.9.4@aar'
}	</code></pre>
					</section>
					<section>
						<h3>Android Manifest</h3>
						<pre><code class="language-java">

&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;manifest xmlns:android="http://schemas.android.com/apk/res/android"
		package="com.workshops.helloworld" &gt;
		&lt;uses-permission
			 android:name="android.permission.SOME_PERMISSION" /&gt;

		&lt;application
				android:allowBackup="true"
				android:icon="@mipmap/ic_launcher"
				android:labelw="@string/app_name"
				android:theme="@style/AppTheme" &gt;
				&lt;activity
						android:name=".MainActivity"
						android:label="@string/app_name" &gt;
						&lt;intent-filter&gt;
								&lt;action android:name="android.intent.action.MAIN" /&gt;
								&lt;category android:name="android.intent.category.LAUNCHER" /&gt;
						&lt;/intent-filter&gt;
				&lt;/activity&gt;
		&lt;/application&gt;

&lt;/manifest&gt;
					</code></pre>
					</section>

					<section data-markdown>
						##Resources

						* Drawable <!-- .element: class="fragment" -->
						* Layout <!-- .element: class="fragment" -->
						* Values <!-- .element: class="fragment" -->
							* Styles <!-- .element: class="fragment" -->
							* Strings <!-- .element: class="fragment" -->
							* Colors <!-- .element: class="fragment" -->
							* Dimens <!-- .element: class="fragment" -->

					</section>
				</section>

				<section>
					<section>
						<h3>Budujmy!</h3>
					</section>
					<section>
						<h2>Nowy projekt</h2>
					</section>
					<section>
						<h2>Stworzyć obiekt Application</h2>
					</section>

					<section>
						<h3>Wpis w android manifest</h3>
						<pre><code class="language-java">
android:name=".ApplicationKYN2016"
						</code></pre>
					</section>

					<section>
						<h3>Znajdowanie beaconoów</h3>
					<pre><code class="language-java">
public void startRanging(){
	mBeaconManager.connect(new BeaconManager.ServiceReadyCallback() {
		@Override
		public void onServiceReady() {
				mBeaconManager.startNearableDiscovery();
		}
	});
}

public void stopRanging(){
	mBeaconManager.disconnect();
}
						</code></pre>
					</section>

						<section>
							<h2>Wykrywanie beaconów</h2>
							<pre><code class="language-java">
mBeaconManager.setNearableListener(new BeaconManager.NearableListener() {
	@Override
	public void onNearablesDiscovered(List&lt;Nearable&gt;nearables) {
		for(Nearable nearable: nearables) {
			Log.d("beacon", nearable.identifier);
		}
	}
});</code></pre>
						</section>

						<section>
							<h2>Rozpocząć skanowanie!</h2>
							<pre><code class="language-java">
@Override
protected void onStart() {
	super.onStart();
	mApplication.startRanging();
}

@Override
protected void onDestroy() {
	super.onDestroy();
	mApplication.stopRanging();
}
							</code></pre>
						</section>

						<section>
							<h3>Tak, ten błąd był oczekiwany</h3>
						</section>

						<section>
							Permisions
							<pre><code class="language-java">
&lt;uses-permission android:name="android.permission.BLUETOOTH_ADMIN" /&gt;
&lt;uses-permission android:name="android.permission.INTERNET"  /&gt;
&lt;uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" /&gt;
&lt;uses-permission android:name="android.permission.ACCESS_FINE_LOCATION" /&gt;
							</code></pre>
						</section>


					<section>
						Stwórz nową klasę - <em>BeaconItem</em>
						<pre><code class="language-java">public class BeaconItem {
    private String name;
    private String id;
    private static Map&lt;String, String&gt; beaconMap;

    static {
        beaconMap = new HashMap<>();
        beaconMap.put("33927f15e3b75104", "fridge");
        beaconMap.put("66fc8e73f145e172", "door");
        beaconMap.put("0929888a57bf4fb7", "bag");
        beaconMap.put("3f2ac3b188b1adfc", "bike");
        beaconMap.put("0a296db82040d52d", "chair");
        beaconMap.put("bbe08f1308d5093f", "car");
        beaconMap.put("84b70d36fd22d5a6", "generic");
        beaconMap.put("5085ab2174e6ffff", "bed");
        beaconMap.put("bb6820d988547674", "dog");
        beaconMap.put("389a2f206e537f96", "shoe");
    }
}					</code></pre>
					</section>
				<section>Dodaj konstruktor oraz metodę tworzącą listę obiektów z listy id
						<pre><code class="language-java">private BeaconItem(String name, String id){
        this.name = name;
        this.id = id;
    }

    public static ArrayList&lt;BeaconItem&gt; fromList(List&lt;String&gt; idList){
        ArrayList&lt;BeaconItem&gt; beaconList = new ArrayList&lt;&gt;();
        for (String id : idList){
            beaconList.add(new BeaconItem(beaconMap.get(id), id));
        }

        return beaconList;
    }</code></pre>
    				</section>
    				<section>
    				Dodaj gettery dla pól <em>id</em> oraz <em>name</em>
						<pre><code class="language-java">public String getName() {
        return name;
    }

public String getId() {
        return id;
    }</code></pre>
    				</section>
    				<section>
    				Stwórz nowy layout - <em>beacon_item.xml</em> w katalogu <em>layout</em>
						<pre><code class="language-java">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;LinearLayout
    xmlns:android="http://schemas.android.com/apk/res/android"
    android:orientation="horizontal"
    android:layout_width="match_parent"
    android:layout_height="match_parent"&gt;

&lt;/LinearLayout&gt;</code></pre>
    				</section>
    				<section>
    				Dodaj do <em>Linear Layout</em> pola: <em>ImageView</em> oraz <em>TextView</em>
						<pre><code class="language-java">&lt;ImageView android:id="@+id/icon"
    android:layout_width="75dp"
    android:layout_height="75dp" /&gt;

&lt;TextView android:id="@+id/name"
    android:layout_width="wrap_content"
    android:layout_height="wrap_content"
    android:layout_marginStart="15dp"
    android:layout_gravity="center_vertical"
    android:fontFamily="sans-serif-thin"
    android:textSize="24sp"/&gt;</code></pre>
    				</section>
    				<section>
    				Stwórz nową klasę: <em>BeaconArrayAdapter</em> i zaimplementuj konstruktor oraz pole <em>Context</em>
						<pre><code class="language-java">public class BeaconArrayAdapter extends ArrayAdapter&lt;BeaconItem&gt;{
    private Context mContext;

    public BeaconArrayAdapter(Context context, ArrayList&lt;BeaconItem&gt; beacons) {
        super(context, 0, beacons);
        this.mContext = context;
    }
}</code></pre>
    				</section>
    				<section>
    				Nadpisz wymaganą metodę <em>getView()</em>
						<pre><code class="language-java">@Override
public View getView(int position, View convertView, ViewGroup parent) {
    BeaconItem item = getItem(position);

    if (convertView == null) {
        convertView = LayoutInflater.from(getContext())
        	.inflate(R.layout.beacon_item, parent, false);
    }

    ImageView icon = (ImageView) convertView.findViewById(R.id.icon);
    TextView name = (TextView) convertView.findViewById(R.id.name);

    Resources resources = mContext.getResources();
    final int resourceId = resources.getIdentifier(item.getName(),
    	"drawable", mContext.getPackageName());
</code></pre>
    				</section>
    				<section>
						<pre><code class="language-java">
    icon.setImageResource(resourceId);
    name.setText(item.getName());

    return convertView;
}</code></pre>
    				</section>
    				<section>
    				Stwórz nowy Blank Fragment - <em>BeaconListFragment</em>
						<pre><code class="language-java">public class BeaconListFragment extends Fragment {
    public BeaconListFragment() {
        // Required empty public constructor
    }

    @Override
    public View onCreateView(LayoutInflater inflater, ViewGroup container,
                             Bundle savedInstanceState) {
        // Inflate the layout for this fragment
        return inflater.inflate(R.layout.fragment_beacon_list, container,
        	false);
    }
}
</code></pre>
    				</section>
						<section>
    				Dodanie fragmentu w main activity
						<pre><code class="language-java">if (savedInstanceState == null) {
  getFragmentManager().beginTransaction()
    .add(R.id.main_fragment, new BeaconListFragment(), "BeaconListFragment").commit();
}
</code></pre>
    				</section>
						<section>
    				Dodanie <em>Frame Layout</em>
						<pre><code class="language-java">&lt;FrameLayout android:id="@+id/main_fragment"
  android:layout_width="fill_parent"
  android:layout_height="fill_parent"&gt;
    </FrameLayout>
</code></pre>
    				</section>
    				<section>
    				W utworzonym pliku <em>fragment_beacon_list.xml</em> dodaj <em>ListView</em>
						<pre><code class="language-java">&lt;ListView android:id="@+id/beacon_list"
	android:layout_width="match_parent"
	android:layout_height="wrap_content" /&gt;
</code></pre>
    				</section>
    				<section>
    				Zmień metodę <em>onCreateView</em> aby <em>View</em> był zwracany na końcu
						<pre><code class="language-java">@Override
public View onCreateView(LayoutInflater inflater, ViewGroup container,
                         Bundle savedInstanceState) {
    // Inflate the layout for this fragment
    View view = inflater.inflate(R.layout.fragment_beacon_list, container,
    	false);

    return view;
}

</code></pre>
    				</section>
    				<section>
    				Dodaj pola do klasy
						<pre><code class="language-java">private ListView mBeaconList;
private ApplicationKYN2016 mApplication;
private Handler mHandler;
private List&lt;String&gt; mDataset;
private ProgressDialog mProgress;

private static final Integer UPDATE_LIST_INTERVAL = 4 * 1000;
</code></pre>
    				</section>
    				<section>
    				Zainicjalizuj dodane pola oraz wyświetl okienko ładowania
						<pre><code class="language-java">mApplication = (ApplicationKYN2016) getActivity().getApplication();
mBeaconList = (ListView) view.findViewById(R.id.beacon_list);
mDataset = new ArrayList<>();
mHandler = new Handler();

mProgress = ProgressDialog.show(getActivity(), "",
        "Skanowanie beaconów...", true);
</code></pre>
    				</section>
    				<section>
    				Stwórz <em>OnClickItemListener</em> dla listy
						<pre><code class="language-java">AdapterView.OnItemClickListener itemClickListener =
	new AdapterView.OnItemClickListener() {
    @Override
    public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position,
    	long id) {

    }
};

mBeaconList.setOnItemClickListener(itemClickListener);
</code></pre>
    				</section>
    				<section>
    				W środku metody <em>onItemClick()</em> wyświetl komunikat o id wybranego beacona
						<pre><code class="language-java">@Override
public void onItemClick(AdapterView&lt;?&gt; parent, View view, int position,
	long id) {
	BeaconItem beacon = (BeaconItem)parent.getItemAtPosition(position);
	Toast toast = Toast.makeText(getActivity(), beacon.getId(),
		Toast.LENGTH_LONG);
	toast.show();
}
</code></pre>
    				</section>
							<section>

							<h2>Odświeżanie listy</h2>
							<pre><code class="language-java">
private void updateAvailableBeacons(){
	Set&lt;Nearable&gt; nearables = mApplication.getTemperatureMap().keySet();
	for(Nearable nearable: nearables) {
		if(!mDataset.contains(nearable.identifier)) {
			if (mProgress.isShowing())
				mProgress.dismiss();
			mDataset.add(nearable.identifier);
		}
	}

	BeaconArrayAdapter beaconAdapter = new BeaconArrayAdapter(getActivity(), BeaconItem.fromList(mDataset));
	mBeaconList.setAdapter(beaconAdapter);

	beaconAdapter.notifyDataSetChanged();
}
							</code></pre>
						</section>

						<section>
							<h2>Runnable</h2>
							<pre><code class="language-java">
final Runnable updateBeaconList = new Runnable() {
	@Override
	public void run() {
		try {
		pdateAvailableBeacons();
		} finally {
		mHandler.postDelayed(updateBeaconList, UPDATE_LIST_INTERVAL);
		}
	}
};
							</code></pre>
						</section>

					<section>
						<h2>Koniec części pierwszej</h2>
					</section>

				</section>

			</div>
		</div>

		<script src="lib/js/head.min.js"></script>
		<script src="js/reveal.js"></script>

		<script>

			// Full list of configuration options available at:
			// https://github.com/hakimel/reveal.js#configuration
			Reveal.initialize({
				controls: true,
				progress: true,
				history: true,
				center: true,

				transition: 'slide', // none/fade/slide/convex/concave/zoom

				// Optional reveal.js plugins
				dependencies: [
					{ src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
					{ src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
					{ src: 'plugin/highlight/highlight.js', async: true, condition: function() { return !!document.querySelector( 'pre code' ); }, callback: function() { hljs.initHighlightingOnLoad(); } },
					{ src: 'plugin/zoom-js/zoom.js', async: true },
					{ src: 'plugin/notes/notes.js', async: true }
				]
			});

		</script>

	</body>
</html>
